<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QSD ‚Äî Ultimate Glitch Vault (Combined Chaos)</title>
<style>
  /* BASE: mix of polished container + gross early-2000s forum glitch */
  :root{--bg1:#0b0b0b;--panel:#0f0f10;--accent:#ff4da6;--muted:#9b9b9b}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg1) 0%, #111 70%);color:#eaeaea;font-family: 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial}
  .wrap{max-width:1200px;margin:18px auto;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.006));border-radius:12px;box-shadow:0 8px 40px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.03)}

  header{display:flex;align-items:center;gap:14px}
  .logo{font-weight:900;font-size:28px;letter-spacing:0.6px;font-family: 'Impact', 'Arial Black', sans-serif;color:var(--accent)}
  .tag{font-size:12px;color:var(--muted)}

  /* FLASHING BANNER (big & 2006 forum vibes) */
  .banner{margin:14px 0;padding:10px;border-radius:8px;display:flex;align-items:center;justify-content:space-between;gap:12px;background:repeating-linear-gradient(45deg, rgba(255,77,166,0.06), rgba(255,77,166,0.06) 6px, transparent 6px, transparent 12px);border:2px dashed rgba(255,77,166,0.12)}
  .banner .marquee{font-family: 'Courier New', monospace;font-weight:700;overflow:hidden;white-space:nowrap}
  .marquee span{display:inline-block;padding-left:100%;animation:marq 12s linear infinite}
  @keyframes marq{0%{transform:translateX(0)}50%{transform:translateX(-50%)}100%{transform:translateX(-100%)}}

  /* layout */
  .grid{display:grid;grid-template-columns:1fr 380px;gap:18px}
  @media(max-width:980px){.grid{grid-template-columns:1fr}}

  /* FORUM / THREAD look */
  .threads{background:linear-gradient(0deg, rgba(255,255,255,0.01), transparent);border-radius:10px;padding:12px;border:1px solid rgba(255,255,255,0.02)}
  .thread{padding:10px;border-bottom:1px solid rgba(255,255,255,0.02);display:flex;align-items:center;gap:12px}
  .thread .title{font-weight:800}
  .thread .meta{font-size:12px;color:var(--muted)}
  .strike{text-decoration:line-through;color:#ffb3d9}
  .upside{display:inline-block;transform:rotate(180deg);font-family: monospace}

  /* MUSIC VAULT */
  .vault{margin-top:12px;background:rgba(0,0,0,0.3);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
  .player{background:rgba(0,0,0,0.4);padding:8px;border-radius:8px;margin-bottom:10px}
  .player .label{font-weight:800}
  .controls{display:flex;gap:8px;margin-top:8px}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:8px;color:#fff;cursor:pointer}

  /* GALLERY */
  .gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:12px}
  @media(max-width:980px){.gallery{grid-template-columns:repeat(2,1fr)}}
  .gallery .tile{background:#0b0b0b;border-radius:8px;overflow:hidden;display:flex;align-items:center;justify-content:center;height:160px;border:1px solid rgba(255,255,255,0.03)}
  .gallery img{max-width:100%;max-height:100%;object-fit:cover}

  /* RULES styled like ToS */
  .rules{margin-top:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);font-size:14px;line-height:1.4}
  .rules h3{margin:0 0 8px 0}
  .emoji{font-size:16px;margin:0 6px}

  /* DM QSD widget */
  .dm{margin-top:12px;background:rgba(0,0,0,0.3);padding:12px;border-radius:10px}
  .chatlog{height:160px;overflow:auto;padding:6px;border-radius:6px;background:#070707;border:1px solid rgba(255,255,255,0.02)}
  .inputrow{display:flex;gap:8px;margin-top:8px}
  input[type=text]{flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:#fff}

  /* right column */
  aside .card{background:linear-gradient(180deg, rgba(0,0,0,0.3), rgba(0,0,0,0.2));Padding:12px;border-radius:10px;margin-bottom:12px;border:1px solid rgba(255,255,255,0.02)}
  .fmbot{font-family:monospace;font-size:13px}

  /* subtle scanlines for 2006 feel */
  .scan{background-image:linear-gradient(rgba(255,255,255,0.005) 1px, transparent 1px);background-size:100% 4px}

  /* misc QSD messy touches */
  .tiny{font-size:12px;color:var(--muted)}
  .mislabeled{color:#ffdcee}

  /* Added from other files */
  .notfound{display:flex;align-items:center;justify-content:center;height:240px;font-size:20px;color:#fff}
  .popup-glinda{position:fixed;right:20px;bottom:20px;background:#111;padding:12px;border-radius:10px;border:2px dashed #ff77cc;color:#fff;z-index:999; display: none;}
  .popup-qsd-watching{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);background:pink;color:black;padding:20px;border:3px dashed lime;z-index:1000;display:none;}
  .emoji-cursor *{cursor:url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22><text y=%2216%22 font-size=%2216%22>üêî</text></svg>') 12 12, auto}
</style>
</head>
<body class="scan emoji-cursor">
  <div class="wrap" id="main-wrap">
    <header>
      <div class="logo">QSD ‚Äî The Ultimate Vault</div>
      <div style="flex:1"></div>
      <div class="tag">glitch pop ‚Ä¢ lore ‚Ä¢ friends-only ‚Ä¢ combined chaos</div>
    </header>

    <div class="banner">
      <div class="marquee"><span>‚ö†Ô∏è WELCOME TO QSD ‚Äî DO NOT BE NORMAL ‚Ä¢ CLICK THINGS ‚Ä¢ POST CURSED FILES ‚Ä¢ STAY WEIRD ‚ö†Ô∏è</span></div>
      <div class="tiny">forum look ‚Ä¢ mislabels ‚Ä¢ cursed embeds</div>
    </div>

    <div class="grid" id="main-grid">
      <main id="main-content">
        <!-- Content sections will be dynamically loaded here -->
      </main>

      <!-- RIGHT COLUMN: controls, fake fmbot, small widgets -->
      <aside>
        <div class="card">
          <h4 style="margin:0">Quick tools</h4>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
            <button class="btn" id="shuffleGallery">shuffle gallery üîÅ</button>
            <button class="btn" id="popupGlinda">summon glinda üëÅÔ∏è</button>
            <button class="btn" id="openSecret">open secret (shh)</button>
            <button class="btn" id="toggle404">glitch 404</button>
          </div>
        </div>

        <div class="card fmbot">
          <div><strong>.fmbot</strong> ‚Äî now playing: <span id="fmbotTrack">RILLOPOP ‚Äî Enzo Mirlo</span></div>
          <div class="tiny">(this is always wrong on purpose)</div>
        </div>

        <div class="card">
          <h4 style="margin:0">DM QSD</h4>
          <div class="dm">
            <div class="chatlog" id="chatlog">
              <!-- Initial chat messages from qsd_website (1).html -->
              <p><b>peri [QUNT]:</b> this song is NOT real</p>
              <p><b>cam ü©∂ [NTTS]:</b> stop lying u made it last night</p>
              <p><b>conraddd ‚òÖ TYRANT [ARCA]:</b> i can SEE it playing rn</p>
              <p><b>zac [ùúóùúö]:</b> lowkey kinda slaps</p>
            </div>
            <div class="inputrow"><input id="dmIn" type="text" placeholder="say something to QSD..."><button class="btn" id="dmSend">send</button></div>
          </div>
        </div>

        <div class="card tiny">
          <strong>roles (emoji ready)</strong><br>üêî Chief Chicken Officer ‚Ä¢ üßå Compression Goblin ‚Ä¢ ‚ö∞ Bassline Necromancer ‚Ä¢ ü©∂ Resident Mood
        </div>
      </aside>
    </div>
  </div>

  <!-- SECRET SECTION (hidden until opened) -->
  <div id="secret" style="display:none;position:fixed;left:6%;top:6%;width:88%;height:88%;background:linear-gradient(180deg,#0b0b0b,#1a001a);border:4px solid #ff4da6;z-index:9999;padding:20px;overflow:auto;color:#fff">
    <h2>secret lore dump</h2>
    <p>here lives the extra nonsense: fake riddles, a tiny discography, cursed ascii art, and a loop player (play at your own risk).</p>
    <button class="btn" id="closeSecret">close secret</button>
  </div>

  <!-- GLINDA POPUP (wild popups) -->
  <div id="glinda" class="popup-glinda">
    <strong>Glinda the Good Hoe</strong>
    <div style="font-size:13px;margin-top:6px">i cannot create content that promotes the use of bodily fluids to grease food. also: someone stole the beat.</div>
  </div>

  <!-- QSD IS WATCHING YOU POPUP -->
  <div id="qsd-watching-popup" class="popup-qsd-watching">
    ‚ö†Ô∏è QSD IS WATCHING YOU üëÅÔ∏èüëÅÔ∏è
  </div>

<script>
  // ---------- SPOTIFY TRACK LIST (will randomize) ----------
  const tracks = [
    {id:'0fhXrzrr7HxpjySMLHVfuj', title:'Basic White Furry Girl'},
    {id:'1geMKO4coMzfY9hw5I4HYQ', title:'beyond my years'},
    {id:'4bLv9iKcgXRg6xSHHjs0S9', title:'pop rocks (mislabeled)'},
    {id:'6rF0xtzz48PtK9NlAOQQEv', title:'furry sounds (pissin & fartin)'},
    {id:'2bMPcswO2Cu9iCzMrNUbbK', title:'deluxe queef edition'},
    {id:'3lQQiEqu2G66GipV2IhM0J', title:'rent money type beat'},
    {id:'7pmnxk69sT3qfIa238k1zr', title:'microwave jazz'},
    {id:'1v1lOVpK9QZKwVeD0YZrkF', title:'screenshot currency'}
  ];

  let currentTrackIndex = 0; // Renamed to avoid conflict with 'current' in other scripts

  function setTrack(n){
    const t = tracks[n % tracks.length];
    const spotPlayer = document.getElementById('spotPlayer');
    const trackTitle = document.getElementById('trackTitle');

    if (trackTitle) trackTitle.textContent = t.title;
    if (spotPlayer) spotPlayer.src = `https://open.spotify.com/embed/track/${t.id}?utm_source=generator`;
    currentTrackIndex = n;
  }

  // Event listeners for music controls (ensure elements exist before adding listeners)
  document.addEventListener('DOMContentLoaded', () => {
    const randTrackBtn = document.getElementById('randTrack');
    const nextTrackBtn = document.getElementById('nextTrack');

    if (randTrackBtn) {
      randTrackBtn.addEventListener('click', () => {
        const n = Math.floor(Math.random() * tracks.length);
        setTrack(n);
      });
    }
    if (nextTrackBtn) {
      nextTrackBtn.addEventListener('click', () => {
        setTrack(currentTrackIndex + 1);
      });
    }

    // Initialize first track
    setTrack(0);
  });


  // ---------- GALLERY ROTATION ----------
  // <<< Replaced galleryImgsPool with the exact tokenized Discord links you provided >>>
  const galleryImgsPool = [
  "assets/images/gallery/A9CAB54D-6C46-47E0-B7D1-1E489A964B88-ezgif.com-video-to-gif-converter.gif",
  "assets/images/gallery/ScreenRecording_04-29-202511-29-58_1-ezgif.com-optimize.gif",
  "assets/images/gallery/Screenshot_20250814-021832.png",
  "assets/images/gallery/Screenshot_20250815-152748.png",
  "assets/images/gallery/Screenshot_20250815-183423.png",
  "assets/images/gallery/Screenshot_20250826_123929_Status.jpg",
  "assets/images/gallery/Screenshot_20250902-023303.png",
  "assets/images/gallery/Screenshot_20250904-005834.png",
  "assets/images/gallery/Screenshot_20250904-122111.png",
  "assets/images/gallery/Screenshot_20250904-191411.png",
  "assets/images/gallery/cynthia-erivo-speechless.gif",
  "assets/images/gallery/cynthia-erivo.gif",
  "assets/images/gallery/danielsmith.png",
  "assets/images/gallery/ethan-slater.gif",
  "assets/images/gallery/fitness_goals.png",
  "assets/images/gallery/gasp-speechless.gif",
  "assets/images/gallery/omgcat.gif",
  "assets/images/gallery/touchstarved.gif",
  "assets/images/gallery/emoji-wow.gif",
  "assets/images/gallery/lady-gaga-awkward.gif",
  "assets/images/gallery/animal-crossing-acnh.gif"
];


  function populateGalleryTiles() {
    const galleryContainer = document.getElementById('gallery');
    if (!galleryContainer) return;

    galleryContainer.innerHTML = ''; // Clear existing tiles
    const shuffledImgs = [...galleryImgsPool].sort(() => Math.random() - 0.5); // Shuffle the pool

    // Create 13 tiles, filling with shuffled images
    for (let i = 0; i < 13; i++) {
      const tile = document.createElement('div');
      tile.className = 'tile';
      const img = document.createElement('img');
      img.src = shuffledImgs[i % shuffledImgs.length]; // Cycle through shuffled images if less than 13
      tile.appendChild(img);
      galleryContainer.appendChild(tile);
    }
  }

  let galleryIntervals = []; // To store intervals for clearing

  function startGalleryCycling() {
    const galleryTiles = Array.from(document.querySelectorAll('#gallery .tile img'));
    // Clear existing intervals to prevent duplicates
    galleryIntervals.forEach(clearInterval);
    galleryIntervals = [];

    galleryTiles.forEach((img, idx) => {
      const interval = setInterval(() => {
        const otherImg = galleryTiles[Math.floor(Math.random() * galleryTiles.length)];
        const tmp = img.src;
        img.src = otherImg.src;
        otherImg.src = tmp;
      }, 3000 + Math.random() * 4000 + idx * 300);
      galleryIntervals.push(interval);
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    populateGalleryTiles(); // Populate on load
    startGalleryCycling(); // Start cycling on load

    const shuffleGalleryBtn = document.getElementById('shuffleGallery');
    if (shuffleGalleryBtn) {
      shuffleGalleryBtn.addEventListener('click', () => {
        populateGalleryTiles(); // Re-populate with new random images
        startGalleryCycling(); // Restart cycling
      });
    }
  });


  // ---------- DM QSD fake replies ----------
  const dmResponses = [
    'STOP LYING I SAW IT',
    'fishy stinky dick',
    'cum server rules v2',
    'peri has 19,828 plays for Kenna Fannee',
    'you are banned again lol',
    'Basic White Furry Girl.mp3 corrupted',
    'i will sample your apology',
    'join vc now or be doomed to spotify shuffle'
  ];
  const chatlog = document.getElementById('chatlog');

  document.addEventListener('DOMContentLoaded', () => {
    const dmSendBtn = document.getElementById('dmSend');
    const dmIn = document.getElementById('dmIn');

    if (dmSendBtn && dmIn && chatlog) {
      dmSendBtn.addEventListener('click', () => {
        const v = dmIn.value.trim();
        if(!v) return;
        const you = document.createElement('p'); // Changed to p for consistency with initial chat
        you.innerHTML = '<b>you:</b> '+escapeHtml(v); chatlog.appendChild(you);
        const reply = document.createElement('p'); // Changed to p
        reply.innerHTML = '<b>QSD:</b> '+dmResponses[Math.floor(Math.random()*dmResponses.length)]; chatlog.appendChild(reply);
        chatlog.scrollTop = chatlog.scrollHeight; dmIn.value='';
      });

      // small accessibility: allow enter to send dm
      dmIn.addEventListener('keydown',e=>{ if(e.key==='Enter'){ dmSendBtn.click(); }});
    }
  });

  function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

  // ----- DM auto messages -----
  // (added exactly as a non-conflicting integration; uses existing `chatlog`)
  const dmBank = [
    `<p><b>Jisenku:</b> omg darling i'm so glad u asked me to do this</p>`,
    `<p><b>peri [QUNT]:</b> since like 2021</p>`,
    `<p><b>conraddd ‚òÖ TYRANT [ARCA]:</b> how have u listened to her sm</p>`,
    `<p><b>zac [ùúóùúö]:</b> He‚Äôs jobless</p>`,
    `<p><b>fmbot APP:</b> Jisenku has 2031 plays for SZA</p>`,
    `<p><b>peri [QUNT]:</b> IS THAT A GROWN MAN</p>`,
    `<p><b>Jisenku:</b> what the fuck</p>`,
    `<p><b>cam ü©∂ [NTTS]:</b> Wait okay daddy.</p>`,
    `<p><b>ùîÇ:</b> My favorite porn stars HELPP</p>`,
    `<p><b>zac [ùúóùúö]:</b> Bigger titties than most women I know</p>`,
    `<p><b>peri [QUNT]:</b> @zac UR DISS PLAYING</p>`,
    `<p><b>ùîÇ:</b> FISHY STINKY DICK</p>`,
    `<p><b>Jisenku:</b> sugar baby on roblox tutorial coming soon</p>`,
    `<p><b>jai [kai]:</b> CASEY WEBER CANT SING</p>`,
    `<p><b>peri [QUNT]:</b> im paying ur rent</p>`,
    `<p><b>Jisenku:</b> the mixtape deluxe is just me queefing on mic</p>`,
    `<p><b>cam ü©∂ [NTTS]:</b> Kms but sending u the song anyways</p>`,
    `<p><b>conraddd ‚òÖ TYRANT [ARCA]:</b> gurl u look like a bull with the vape</p>`,
    `<p><b>ùîÇ:</b> PERI IS SHOWING HIS DICK RN</p>`,
    `<p><b>zac [ùúóùúö]:</b> Lowkey down</p>`,
    // --- new batch ---
    `<p><b>cam ü©µ [NTTS]:</b> I‚Äôm leaking Peri‚Äôs nudes ü§ç</p>`,
    `<p><b>cam ü©µ [NTTS]:</b> @everyone I‚Äôm pregnant and Jai is the baby daddy</p>`,
    `<p><b>cam ü©µ [NTTS]:</b> peri said he‚Äôs gonna sell zac to p diddy</p>`,
    `<p><b>Jisenku:</b> üòù my non-exsistent waist aughghhhh</p>`,
    `<p><b>jai [Î™®ÏïÑ]:</b> can i roll matcha powder into a blunt and then say im off that green</p>`,
    `<p><b>cam ü©µ [NTTS]:</b> Coochie stay waxed so I ain‚Äôt never gotta comb her</p>`,
    `<p><b>cam ü©µ [NTTS]:</b> bb suck these titties</p>`,
    `<p><b>BoltBot‚ö° APP:</b> :warn_v2: Content Safety Filter triggered</p>`,
    `<p><b>Jisenku:</b> half of these people know my address and my happy trail</p>`,
    `<p><b>cam ü©µ [NTTS]:</b> Idgaf about your happy trail I wanna see cock and balls</p>`,
    `<p><b>icey [ari]:</b> they blowin this bitch up harder than 9/11 üòÇ</p>`,
    `<p><b>jai [Î™®ÏïÑ]:</b> pussy fatter than an overweight diabetic child</p>`,
    `<p><b>zac [KATZ]:</b> Well between you and the sex toy, something had to be smart</p>`,
    `<p><b>peri:</b> offspring = children = unborn feti = sperm</p>`,
    `<p><b>icey [ari]:</b> u look schizo</p>`,
    `<p><b>peri:</b> YOU THOUGHT YOU ATE? BUT THE ONLY THING YOU ATE WAS YOUR DOG ASHES</p>`,
    `<p><b>peri:</b> Don‚Äôt make your entire life about gay porn, you have dishes to wash</p>`,
    `<p><b>peri:</b> can someone pls talk i dont wanna look schizophrenic</p>`,
    `<p><b>peri:</b> say hi to jinnawoods, who i haven't talked to since 2022 üò≠</p>`,
    `<p><b>peri:</b> my fursona is orange juice üßÉ üß°</p>`,
    `<p><b>Zac [KATZ]:</b> How u a slut but a virgin? Pick a struggle</p>`,
    `<p><b>Jisenku:</b> she found me on grindr ofc she wrote smth about me</p>`,
    `<p><b>Jisenku:</b> im a filthy little bottom üò©üí¶</p>`,
    `<p><b>Jisenku:</b> STOP SAYING I'VE GONE ON GRINDR</p>`,
    `<p><b>Jisenku:</b> I AM NOT GIVING OUT MY PORN COLLECTION</p>`
  ];

  function injectDM() {
    const msg = dmBank[Math.floor(Math.random()*dmBank.length)];
    if (chatlog) {
      chatlog.insertAdjacentHTML("beforeend", msg);
      chatlog.scrollTop = chatlog.scrollHeight;
    }
  }
  // random every 10‚Äì20s
  setInterval(injectDM, 10000 + Math.random()*10000);


  // ---------- FMBot prank (always wrong) ----------
  const fmbotTrackEl = document.getElementById('fmbotTrack');
  const fakeNowPlaying = [
    'Barbie Girl (Nightcore)',
    'RILLOPOP ‚Äî Enzo Mirlo',
    'Back2U (no rap)',
    'You‚Äôre Listening To: Static Noise',
    'Random Club Banger',
    'Minecraft Cave Noises Extended - QSD Remix',
    'Fergie - National Anthem (Live at Denny‚Äôs)',
    'Silence (8 hours) - LoFi Remix',
    'Cum Angel Theme - unreleased demo',
    'Peri ‚Äî demo (corrupted)'
  ];
  if (fmbotTrackEl) {
    setInterval(()=>{ fmbotTrackEl.textContent = fakeNowPlaying[Math.floor(Math.random()*fakeNowPlaying.length)]; }, 4000);
  }

  // ---------- Popups & Glinda ----------
  document.addEventListener('DOMContentLoaded', () => {
    const popupGlindaBtn = document.getElementById('popupGlinda');
    const glindaPopup = document.getElementById('glinda');

    if (popupGlindaBtn && glindaPopup) {
      popupGlindaBtn.addEventListener('click', () => {
        glindaPopup.style.display='block';
        setTimeout(() => glindaPopup.style.display='none', 6500);
      });
    }

    // Random "QSD is watching you" popups
    const qsdWatchingPopup = document.getElementById('qsd-watching-popup');
    if (qsdWatchingPopup) {
      setInterval(() => {
        if (Math.random() < 0.05) { // 5% chance every 10 seconds
          qsdWatchingPopup.style.display = 'block';
          setTimeout(() => qsdWatchingPopup.style.display = 'none', 3000); // Hide after 3 seconds
        }
      }, 10000);
    }
  });


  // ---------- Secret Section open/close ----------
  document.addEventListener('DOMContentLoaded', () => {
    const openSecretBtn = document.getElementById('openSecret');
    const closeSecretBtn = document.getElementById('closeSecret');
    const secretSection = document.getElementById('secret');

    if (openSecretBtn && secretSection) {
      openSecretBtn.addEventListener('click', () => { secretSection.style.display='block'; });
    }
    if (closeSecretBtn && secretSection) {
      closeSecretBtn.addEventListener('click', () => { secretSection.style.display='none'; });
    }
  });


  // ---------- Glitch 404 ----------
  let is404Active = false;
  document.addEventListener('DOMContentLoaded', () => {
    const toggle404Btn = document.getElementById('toggle404');
    const mainWrap = document.getElementById('main-wrap');

    if (toggle404Btn && mainWrap) {
      toggle404Btn.addEventListener('click', () => {
        is404Active = !is404Active;
        if (is404Active) {
          mainWrap.innerHTML = '<div class="notfound">404 ‚Äî you have been banned by a chicken</div>';
          // Optionally, stop background music or other dynamic elements here
        } else {
          location.reload(); // Simplest way to revert to original state
        }
      });
    }
  });


  // ---------- Console easter egg ----------
  window.qsd = {
    cunty: function(){
      document.body.style.transition='background 0.2s';
      let on = 0;
      const int = setInterval(()=>{ 
        document.body.style.background = on++%2? 'linear-gradient(180deg,#ffb3d9 0%, #ffe6f2 60%)':'linear-gradient(180deg,#0b0b0b 0%, #111 60%)';
        if(on>10){
          clearInterval(int);
          document.body.style.background = 'linear-gradient(180deg,#ffb3d9 0%, #ffe6f2 60%)'; // Ensure it stays pink
        }
      },120);
      alert('üíñ cunty mode activated üíñ');
    }
  };

  // ---------- Dynamic Section Loading and Shuffling ----------
  const sectionsPool = [
    {
      id: "forum-threads",
      title: "Forum threads",
      content: `
        <div class="thread"><div><div class="title">~Casey Weber can't sing~</div><div class="meta tiny">started by <span class="strike">UserX</span> ‚Äî 2 posts</div></div></div>
        <div class="thread"><div><div class="title">help: <span class="upside">i cant stop hearing peri</span></div><div class="meta tiny">1 reply ‚Ä¢ archived</div></div></div>
        <div class="thread"><div><div class="title">how to monetize kids' games (jk)</div><div class="meta tiny">pinned ‚Ä¢ community</div></div></div>
        <div class="thread"><div><div class="title">Top 10 cursed exports</div><div class="meta tiny">peri ‚Ä¢ 2025</div></div></div>
      `
    },
    {
      id: "music-vault",
      title: "Music vault (mislabeled for drama)",
      content: `
        <div class="player" id="player">
          <div class="label mislabeled" id="trackTitle">Basic White Furry Girl</div>
          <div style="margin-top:8px"><iframe id="spotPlayer" style="border-radius:12px" src="https://open.spotify.com/embed/track/0fhXrzrr7HxpjySMLHVfuj?utm_source=generator" width="100%" height="80" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe></div>
          <div class="controls">
            <button class="btn" id="randTrack">switch song üîÄ</button>
            <button class="btn" id="nextTrack">next ‚ûú</button>
            <div class="tiny" style="margin-left:auto">tip: titles lie</div>
          </div>
        </div>
        <div class="tiny" style="margin-top:6px">click the button to swap the embedded player to a random track from the list. labels intentionally mislead for drama.</div>
      `
    },
    {
      id: "screenshot-gallery",
      title: "Screenshot gallery",
      content: `<div class="gallery" id="gallery">
          <div class="tile"><img src="assets/images/gallery/A9CAB54D-6C46-47E0-B7D1-1E489A964B88-ezgif.com-video-to-gif-converter.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/ScreenRecording_04-29-202511-29-58_1-ezgif.com-optimize.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250814-021832.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250815-152748.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250815-183423.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250826_123929_Status.jpg" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250902-023303.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250904-005834.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250904-122111.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/Screenshot_20250904-191411.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/cynthia-erivo-speechless.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/cynthia-erivo.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/danielsmith.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/ethan-slater.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/fitness_goals.png" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/gasp-speechless.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/omgcat.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/touchstarved.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/lady-gaga-awkward.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/emoji-wow.gif" alt=""></div>
           <div class="tile"><img src="assets/images/gallery/animal-crossing-acnh.gif" alt=""></div>
           </div>`
    },
    {
      id: "rules-section",
      title: "QSD TERMS OF SERVICE (read it or don't)",
      content: `
        <p id="dynamic-rules">By entering this digital space you agree to keep the vibe chaotic, consent to being memed, and permit your screenshots to be sampled. <span class="emoji">üê∏</span> Conversations may derail into unrelated lore. <span class="emoji">üíã</span> Voice channels are summoned, not scheduled. <span class="emoji">‚ö†Ô∏è</span> If you break the unspoken contract, expect your apology to be an interlude on a cursed track.</p>
        <p class="tiny">This is a friends-only archive. Respect collaborators, credit samples, and do not leak. Also, post cursed files. Always post cursed files.</p>
      `
    }
  ];

  const rulesPool = [
    "üê∏ No gods, no masters, only chaos üíã",
    "‚ö†Ô∏è Respect the lore, disrespect everything else üê∏",
    "Randomness is law. Law is randomness üíã",
    "QSD is always watching üëÅÔ∏èüëÅÔ∏è",
    "By entering this digital space you agree to keep the vibe chaotic, consent to being memed, and permit your screenshots to be sampled. <span class=\"emoji\">üê∏</span> Conversations may derail into unrelated lore. <span class=\"emoji\">üíã</span> Voice channels are summoned, not scheduled. <span class=\"emoji\">‚ö†Ô∏è</span> If you break the unspoken contract, expect your apology to be an interlude on a cursed track."
  ];

  function renderMainContent() {
    const mainContentDiv = document.getElementById("main-content");
    if (!mainContentDiv) return;

    // Shuffle sections
    const shuffledSections = [...sectionsPool].sort(() => Math.random() - 0.5);
    mainContentDiv.innerHTML = ''; // Clear existing content

    shuffledSections.forEach(sec => {
      const sectionElement = document.createElement("section");
      sectionElement.id = sec.id;
      sectionElement.className = sec.id === "rules-section" ? "rules" : ""; // Apply rules class if it's the rules section
      sectionElement.innerHTML = `<h2>${sec.title}</h2>${sec.content}`;
      mainContentDiv.appendChild(sectionElement);
    });

    // After rendering, re-initialize dynamic elements
    populateGalleryTiles();
    startGalleryCycling();
    randomizeRulesContent();
    setTrack(currentTrackIndex); // Re-set track for the newly rendered player
    bindTrackControls(); // ‚úÖ attach event listeners now that the vault exists
  }

  function randomizeRulesContent() {
    const dynamicRulesEl = document.getElementById('dynamic-rules');
    if (dynamicRulesEl) {
      dynamicRulesEl.innerHTML = rulesPool[Math.floor(Math.random() * rulesPool.length)];
    }
  }

  // Initial render of main content on load
  document.addEventListener('DOMContentLoaded', renderMainContent);

  /// ---------- QSD Random Playlist Background Music (robust) ----------
  (function(){
    const playlist = [
      "https://files.catbox.moe/xg5k18.wav",
      "https://files.catbox.moe/pzso4v.wav",
      "https://files.catbox.moe/q3bgmy.wav",
      "https://files.catbox.moe/cszcfr.wav",
      "https://files.catbox.moe/19u8vc.wav"
    ];

    function pickRandomSong() {
      return playlist[Math.floor(Math.random() * playlist.length)];
    }

    const bgMusic = document.createElement('audio');
    bgMusic.id = 'bg-music';
    bgMusic.preload = 'auto';
    bgMusic.crossOrigin = 'anonymous';
    bgMusic.loop = false; // we'll handle ended -> pick new
    bgMusic.volume = 0.9;
    bgMusic.src = pickRandomSong();
    document.body.appendChild(bgMusic);

    // Try to autoplay immediately; if browser blocks, present a tiny "enable audio" button
    function startBgMusic() {
      bgMusic.play().then(()=> {
        // playing ‚Äî nothing to do
      }).catch((err)=>{
        // autoplay blocked, show unobtrusive enable button if not already present
        if (!document.getElementById('enable-audio-btn')) {
          const btn = document.createElement('button');
          btn.id = 'enable-audio-btn';
          btn.className = 'btn';
          btn.textContent = 'üîä enable audio';
          // style it unobtrusively
          btn.style.position = 'fixed';
          btn.style.bottom = '12px';
          btn.style.right = '12px';
          btn.style.zIndex = 10000;
          btn.style.opacity = 0.92;
          btn.style.padding = '8px 12px';
          btn.style.backdropFilter = 'blur(4px)';
          btn.style.border = '1px solid rgba(255,255,255,0.08)';
          btn.addEventListener('click', function(){
            bgMusic.play().catch(()=>{});
            // remove the button after first use
            btn.remove();
          }, { once: true });
          document.body.appendChild(btn);
        }
      });
    }

    startBgMusic();

    // also attach a one-time global click to unlock playback if user interacts anywhere
    function onFirstInteraction() {
      bgMusic.play().catch(()=>{});
      window.removeEventListener('pointerdown', onFirstInteraction);
      window.removeEventListener('keydown', onFirstInteraction);
    }
    window.addEventListener('pointerdown', onFirstInteraction, { once: true });
    window.addEventListener('keydown', onFirstInteraction, { once: true });

    // when a track ends, pick another random one and play
    bgMusic.addEventListener('ended', () => {
      setTimeout(()=>{
        bgMusic.src = pickRandomSong();
        bgMusic.load();
        bgMusic.play().catch(()=>{});
      }, 150); // tiny gap so buffering starts reliably
    });
  })();


  function bindTrackControls() {
    const randTrackBtn = document.getElementById('randTrack');
    const nextTrackBtn = document.getElementById('nextTrack');

    if (randTrackBtn) {
      randTrackBtn.addEventListener('click', () => {
        const n = Math.floor(Math.random() * tracks.length);
        setTrack(n);
      });
    }
    if (nextTrackBtn) {
      nextTrackBtn.addEventListener('click', () => {
        setTrack(currentTrackIndex + 1);
      });
    }
  }


</script>
</body>
</html>
